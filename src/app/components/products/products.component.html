<section class="products page-width">
  <div class="products__header">
    <h1>Todos los Productos</h1>
  </div>

  <div class="products__container">
    <aside class="products__sidebar">
      <p-accordion value = "0">
        <p-accordion-panel value = "0">
          <p-accordion-header>
            <h4 class="products__filter-title">Tipo de Producto</h4>
          </p-accordion-header>
          <p-accordion-content>
            <div class="flex flex-col gap-4">
                @for (category of categories; track category.label) {
                  <div class="flex items-center">
                    <p-checkbox [inputId]="category.label" name="group" [value]="category" [(ngModel)]="selectedCategories" />
                    <label [for]="category.label" class="ml-2"> {{ category.value }} </label>
                  </div>
                }
            </div>
          </p-accordion-content>
        </p-accordion-panel>
      </p-accordion>      
    </aside>

    <!-- Main Content Area -->
    <div class="products__main">
      <!-- Loading state -->
      @if (isLoadingProducts) {
        <div class="products__loading">
          <i class="pi pi-spin pi-spinner text-2xl"></i>
          <p class="mt-2">Cargando productos...</p>
        </div>
      }

      <!-- Error state -->
      @if (productsError && !isLoadingProducts) {
        <div class="products__error">
          <i class="pi pi-exclamation-triangle text-2xl"></i>
          <p class="mt-2">{{ productsError }}</p>
        </div>
      }

      <!-- Products grid -->
      @if (!isLoadingProducts && !productsError) {          
        @for (product of filteredProducts; track product.id) {                     
          <div class="border border-surface rounded-border m-2 p-4">
              <div class="mb-4">
                  <div class="relative mx-auto">
                      <img [src]="product.imageUrl" [alt]="product.name" class="w-full rounded-border" />                         
                  </div>
              </div>
              <div class="mb-4 font-medium">{{ product.name || 'Product Name' }}</div>
              <div class="flex justify-between items-center">
                  <div class="mt-0 font-semibold text-xl">${{ product.price ? product.price.toFixed(2) : '0.00' }}</div>                     
              </div>
          </div>                          
      }          

        <!-- No results message -->
        @if (filteredProducts.length === 0) {
          <div class="products__no-results">
            <p>No se encontraron productos para este filtro.</p>
          </div>
        }
      }
    </div>
  </div>
</section>
